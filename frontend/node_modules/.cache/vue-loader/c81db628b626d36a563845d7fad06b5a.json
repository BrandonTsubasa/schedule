{"remainingRequest":"/Users/tsubasa/project/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/tsubasa/project/frontend/src/views/Task.vue?vue&type=style&index=0&id=f1d4c382&scoped=true&lang=css&","dependencies":[{"path":"/Users/tsubasa/project/frontend/src/views/Task.vue","mtime":1625738578510},{"path":"/Users/tsubasa/project/frontend/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/tsubasa/project/frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/tsubasa/project/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/tsubasa/project/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKI3Rhc2sgewogIHdpZHRoOiAxMDAlOwogIGhlaWdodDogMTAwJTsKfQpoMSB7CiAgaGVpZ2h0OiA1MHB4Owp9CiNidG5Db2xvciB7CiAgYm9yZGVyLWNvbG9yOiAjMDQ3NGJkOwogIGJhY2tncm91bmQtY29sb3I6ICMwNDljZmM7CiAgY29sb3I6IHdoaXRlOwp9Cg=="},{"version":3,"sources":["Task.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkoBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Task.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div id=\"task\">\n    <v-container>\n      <!-- <ValidationObserver> -->\n        <v-row>\n          <v-col cols=\"6\">\n            <!-- <ValidationProvider> -->\n              <v-text-field\n              v-model=\"taskName\"\n              type=\"text\"\n              autofocus\n              :placeholder=\"words[0]\"\n              />\n            <!-- </ValidationProvider> -->\n          </v-col>\n          <v-col cols=\"3\">\n            <v-select\n            :items=\"priority\"\n            @change=\"fetchPriority\"\n            :label=\"words[1]\">\n            </v-select>\n          </v-col>\n          <v-col cols=\"3\">\n            <v-select\n            :items=\"status\"\n            @change=\"fetchStatus\"\n            :label=\"words[2]\">\n            </v-select>\n          </v-col>\n        </v-row>\n\n          <v-row>\n            <v-col cols=\"2\">\n              <v-menu\n              ref=\"menu\"\n              v-model=\"menu\"\n              :close-on-content-click=\"false\"\n              :return-value.sync=\"date\"\n              transition=\"scale-transition\"\n              persistent\n              offset-y\n              min-width=\"auto\"\n              >\n                <template v-slot:activator=\"{ on, attrs }\">\n                  <v-text-field\n                  v-model=\"date\"\n                  :label=\"words[3]\"\n                  prepend-icon=\"mdi-calendar\"\n                  readonly\n                  v-bind=\"attrs\"\n                  v-on=\"on\"\n                  >\n                  </v-text-field>\n                </template>\n                <v-date-picker\n                v-model=\"date\"\n                scrollable\n                header-color=\"primary\">\n                <v-spacer></v-spacer>\n                <v-btn\n                  text\n                  color=\"primary\"\n                  @click=\"menu = false\"\n                >\n                  {{ words[4] }}\n                </v-btn>\n                <v-btn\n                  text\n                  color=\"primary\"\n                  @click=\"$refs.menu.save(date)\"\n                >\n                  {{ words[5] }}\n                </v-btn>\n                </v-date-picker>\n              </v-menu>\n            </v-col>\n\n            <v-col cols=\"2\">\n              <v-menu\n              ref=\"menu2\"\n              v-model=\"menu2\"\n              :close-on-content-click=\"false\"\n              :nudge-right=\"40\"\n              :return-value.sync=\"time\"\n              transition=\"scale-transition\"\n              offset-y\n              max-width=\"290px\"\n              min-width=\"290px\"\n              >\n                <template v-slot:activator=\"{ on, attrs }\">\n                <v-text-field\n                  v-model=\"time\"\n                  :label=\"words[6]\"\n                  prepend-icon=\"mdi-clock-time-four-outline\"\n                  readonly\n                  v-bind=\"attrs\"\n                  v-on=\"on\"\n                ></v-text-field>\n                </template>\n                <v-time-picker\n                  v-if=\"menu2\"\n                  v-model=\"time\"\n                  full-width\n                >\n                <v-spacer></v-spacer>\n                <v-btn\n                  text\n                  color=\"primary\"\n                  @click=\"menu2 = false\"\n                >\n                  {{ words[4] }}\n                </v-btn>\n                <v-btn\n                  text\n                  color=\"primary\"\n                  @click=\"$refs.menu2.save(time)\"\n                >\n                  {{ words[5] }}\n                </v-btn>\n                </v-time-picker>\n              </v-menu>\n            </v-col>\n\n            <v-col cols=\"2\">\n              <v-menu\n              ref=\"menu3\"\n              v-model=\"menu3\"\n              :close-on-content-click=\"false\"\n              :return-value.sync=\"date2\"\n              transition=\"scale-transition\"\n              persistent\n              offset-y\n              min-width=\"auto\"\n              >\n                <template v-slot:activator=\"{ on, attrs }\">\n                  <v-text-field\n                  v-model=\"date2\"\n                  :label=\"words[7]\"\n                  prepend-icon=\"mdi-calendar\"\n                  readonly\n                  v-bind=\"attrs\"\n                  v-on=\"on\"\n                  >\n                  </v-text-field>\n                </template>\n                <v-date-picker\n                v-model=\"date2\"\n                scrollable\n                header-color=\"primary\">\n                <v-spacer></v-spacer>\n                <v-btn\n                  text\n                  color=\"primary\"\n                  @click=\"menu3 = false\"\n                >\n                  {{ words[4] }}\n                </v-btn>\n                <v-btn\n                  text\n                  color=\"primary\"\n                  @click=\"$refs.menu3.save(date2)\"\n                >\n                  {{ words[5] }}\n                </v-btn>\n                </v-date-picker>\n              </v-menu>\n            </v-col>\n\n            <v-col cols=\"2\">\n              <v-menu\n              ref=\"menu4\"\n              v-model=\"menu4\"\n              :close-on-content-click=\"false\"\n              :nudge-right=\"40\"\n              :return-value.sync=\"time2\"\n              transition=\"scale-transition\"\n              offset-y\n              max-width=\"290px\"\n              min-width=\"290px\"\n              >\n                <template v-slot:activator=\"{ on, attrs }\">\n                <v-text-field\n                  v-model=\"time2\"\n                  :label=\"words[8]\"\n                  prepend-icon=\"mdi-clock-time-four-outline\"\n                  readonly\n                  v-bind=\"attrs\"\n                  v-on=\"on\"\n                ></v-text-field>\n                </template>\n                <v-time-picker\n                  v-if=\"menu4\"\n                  v-model=\"time2\"\n                  full-width\n                >\n                <v-spacer></v-spacer>\n                <v-btn\n                  text\n                  color=\"primary\"\n                  @click=\"menu4 = false\"\n                >\n                  {{ words[4] }}\n                </v-btn>\n                <v-btn\n                  text\n                  color=\"primary\"\n                  @click=\"$refs.menu4.save(time2)\"\n                >\n                  {{ words[5] }}\n                </v-btn>\n                </v-time-picker>\n              </v-menu>\n            </v-col>\n\n            <v-col cols=\"4\">\n              <v-select\n              :items=\"userInfo\"\n              v-model=\"selected\"\n              item-text=\"name\"\n              item-value=\"id\"\n              :label=\"words[9]\">\n              </v-select>\n            </v-col>\n          </v-row>\n\n          <v-row>\n            <v-col>\n              <v-btn medium id=\"btnColor\" class=\"font-weight-bold\" @click=\"addTodo\">\n                {{ words[10] }}\n              </v-btn>\n            </v-col>\n          </v-row>\n        </v-container>\n      <!-- </ValidationObserver> -->\n      \n\n    <v-container>\n      <v-card class=\"py-5\">\n        <v-row>\n          <v-col>\n            <v-card-title>\n              {{ words[19] }}\n              <v-spacer></v-spacer>\n              <v-text-field\n                v-model=\"search\"\n                :append-icon=\"words[21]\"\n                :label=\"words[20]\"\n                single-line\n                hide-details\n              ></v-text-field>\n            </v-card-title>\n            <v-data-table\n            :headers=\"headers\"\n            :items=\"tableDatas\"\n            :loading=\"loading\"\n            :search=\"search\"\n            locale=\"ja\"\n            >\n            <template v-slot:[`item.priority`]=\"{ item }\">\n              <v-chip\n                :color=\"getColor(item.priority)\"\n                dark\n              >\n                {{ item.priority }}\n              </v-chip>\n            </template>\n            <template v-slot:top>\n              <v-dialog v-model=\"dialogEdit\" fullscreen max-width=\"600px\" height=\"auto\">\n                <v-card>\n                  <v-card-title>\n                    <span class=\"headline\">{{ words[17] }}</span>\n                  </v-card-title>\n                  <v-card-text>\n                    <v-container>\n                      <v-row>\n                        <v-col>\n                          <v-text-field v-model=\"editedItem.task_name\" :label=\"words[11]\">\n                          </v-text-field>\n                        </v-col>\n                      </v-row>\n\n                      <v-row>\n                        <v-col>\n                          <v-text-field v-model=\"editedItem.priority\" :label=\"words[1]\">\n                          </v-text-field>\n                        </v-col>\n                        <v-col>\n                          <v-text-field v-model=\"editedItem.status\" :label=\"words[2]\"></v-text-field>\n                        </v-col>\n                      </v-row>\n\n                      <v-row>\n                        \n                      </v-row>\n\n                    </v-container>\n                  </v-card-text>\n                  <v-card-text>\n                    <v-card-actions>\n                      <v-btn @click=\"closeEdit\">{{ words[12] }}</v-btn>\n                      <v-btn @click=\"updateEdit\">{{ words[13] }}</v-btn>\n                      <v-spacer></v-spacer>\n                    </v-card-actions>\n                  </v-card-text>\n                </v-card>\n                <v-spacer></v-spacer>\n              </v-dialog>\n              <v-dialog v-model=\"dialogDelete\" max-width=\"500px\">\n                <v-card>\n                  <v-card-title class=\"text-h5\">{{ words[14] }}</v-card-title>\n                  <v-card-actions>\n                    <v-spacer></v-spacer>\n                    <v-btn @click=\"closeDelete\">{{ words[12] }}</v-btn>\n                    <v-btn @click=\"deleteItemConfirm\">{{ words[18] }}</v-btn>\n                    <v-spacer></v-spacer>\n                  </v-card-actions>\n                </v-card>\n              </v-dialog>\n              <v-dialog v-model=\"dialogFinish\" max-width=\"500px\">\n                <v-card>\n                  <v-card-title class=\"text-h5\">{{ words[23] }}</v-card-title>\n                  <v-card-actions>\n                    <v-spacer></v-spacer>\n                    <v-btn @click=\"closeFinish\">{{ words[24] }}</v-btn>\n                    <v-btn @click=\"finishItemConfirm\">{{ words[25] }}</v-btn>\n                    <v-spacer></v-spacer>\n                  </v-card-actions>\n                </v-card>\n              </v-dialog>\n            </template>\n\n            <template v-slot:[`item.actions`]=\"{ item }\">\n              <v-btn\n              small\n              @click=\"editItem(item)\"\n              >\n              <v-icon>\n                {{ words[15] }}\n              </v-icon>\n              </v-btn>\n                <v-btn\n                small\n                @click=\"deleteItem(item)\"\n                >\n                <v-icon>\n                  {{ words[16] }}\n                </v-icon>\n              </v-btn>\n            </template>\n\n            <template v-slot:[`item.finish`]=\"{ item }\">\n                <v-btn\n                small\n                class=\"blue lighten-2 font-weight-bold white--text\"\n                @click=\"finishedItem(item)\"\n                >\n                {{ words[22] }}\n                </v-btn>\n            </template>\n            </v-data-table>\n          </v-col>\n        </v-row>\n      </v-card>\n    </v-container>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport MyApi from \"@/common/myApi.js\";\nimport MyEnum from \"@/common/myEnum.js\";\nimport moment from \"moment\";\n\nexport default {\n  name: \"task\",\n  data: () => ({\n    dialogEdit: false,\n    dialogDelete:false,\n    dialogFinish: false,\n    loading: false,\n    search: \"\",\n    taskName: \"\",\n    priority: [\"高い\",\"普通\",\"低い\"],\n    selectedPriority: null,\n    status: [\"未着手\", \"完了\"],\n    selectedStatus: null,\n    userInfo: [],\n    selected: [],\n    date: null,\n    date2: null,\n    time: null,\n    time2: null,\n    taskData: null,\n    menu: false,\n    menu2: false,\n    menu3: false,\n    menu4: false,\n    headers : [\n      { text: \"ID\", value: \"task_id\"},\n      { text: \"タスク名\", value: \"task_name\"},\n      { text: \"緊急度\", value: \"priority\"},\n      { text: \"状態\", value: \"status\"},\n      { text: \"開始日\", value: \"start_date\"},\n      { text: \"終了日\", value: \"end_date\"},\n      { text: \"名前\", value: \"user_name\"},\n      { text: \"編集 / 削除\", value: \"actions\", sortable: false},\n      { text: \"完了\", value: \"finish\", sortable: false},\n    ],\n    beforeDatas: [],\n    tableDatas: [],\n    editedItem: {\n      task_name: \"\",\n      priority: [],\n      status: [],\n      start_date: null,\n      end_date: null,\n      user_name: \"\"\n    },\n    words: [\n      \"タスク名を入力してください\",\n      \"緊急度\",\n      \"状態\",\n      \"開始日\",\n      \"Cancel\",\n      \"OK\",\n      \"開始時間\",\n      \"終了日\",\n      \"終了時間\",\n      \"名前\",\n      \"追加\",\n      \"タスク名\",\n      \"閉じる\",\n      \"更新する\",\n      \"本当に削除しますか？\",\n      \"mdi-pencil\",\n      \"mdi-delete\",\n      \"編集\",\n      \"削除\",\n      \"Task\",\n      \"検索\",\n      \"mdi-magnify\",\n      \"完了\",\n      \"選択したタスクの状態を完了にします。よろしいでしょうか？\",\n      \"いいえ\",\n      \"はい\",\n    ]\n  }),\n  methods: {\n    fetchPriority(event){\n      this.selectedPriority = event;\n    },\n    fetchStatus(event){\n      this.selectedStatus = event;\n    },\n    getTasks: function() {\n      axios({\n        method: \"get\",\n        url: MyApi.apis().taskList,\n        headers: {\n          Authorization: `JWT ${localStorage.getItem(\"JWT\")}`\n        },\n      })\n      .then(response =>{\n        this.beforeDatas = response?.data;\n        this.tableDatas = this.beforeDatas;\n        this.beforeDatas = this.beforeDatas.map(data => {\n          const result = this.userInfo.find(({id})=>{\n            return id === data.user_name;\n          });\n          data.user_name = result.name;\n        })\n      })\n      .catch(function (error){\n        console.log(error);\n      })\n    },\n\n    addTodo: function() {\n      const startTime = moment(`${this.date} ${this.time}`);\n      const endTime = moment(`${this.date2} ${this.time2}`);\n      if (this.taskName === \"\") {\n        alert(\"作業名を入力してください\");\n        return;\n      }\n      axios({\n        method: \"post\",\n        url: MyApi.apis().taskCreate,\n        headers: {\n          Authorization: `JWT ${localStorage.getItem(\"JWT\")}`\n        },\n        data: {\n          task_name: this.taskName,\n          user_name: this.selected,\n          status: this.selectedStatus,\n          priority: this.selectedPriority,\n          start_date: startTime,\n          end_date: endTime,\n        },\n      })\n      .then(response =>{\n        console.log(response);\n      })\n      .catch(function(error){\n        console.log(error);\n      })\n      this.taskName = \"\";\n      this.selected = \"\";\n      this.date = null;\n      this.time = null;\n      this.date2 = null;\n      this.time2 = null;\n\n      this.getTasks();\n    },\n\n    editItem(item) {\n      // console.log(item);\n      this.editedItem = Object.assign({}, item);\n      this.dialogEdit = true;\n    },\n\n    deleteItem (item) {\n      this.taskData = item;\n      this.dialogDelete = true;\n    },\n    closeEdit: function(){\n      this.dialogEdit = false;\n    },\n    closeDelete: function(){\n      this.dialogDelete = false;\n    },\n    deleteItemConfirm: function(){\n      const id = this.taskData.task_id;\n      axios({\n        method: \"delete\",\n        url: `${MyApi.apis().taskDelete + id}/`,\n        headers: {\n          Authorization: `JWT ${localStorage.getItem(\"JWT\")}`\n        }\n      })\n      .then(response =>{\n        console.log(response);\n      })\n      .catch(function (error){\n        console.log(error);\n      })\n      this.dialogDelete = false;\n      this.getTasks();\n    },\n    tokenCheck: function(){\n      const token = localStorage.getItem(\"JWT\");\n      if (!token){\n        this.$router.push(MyEnum.menuPages().SignIn);\n      }\n    },\n    getColor: function(item){\n      if (item === \"高い\"){\n        return \"red\";\n      }\n      else if(item === \"低い\"){\n        return \"blue\";\n      }\n      else{\n        return \"grey\";\n      }\n    },\n    getUserList: function() {\n      const self = this;\n\n    axios({\n      method: \"get\",\n      url: MyApi.apis().userList,\n      headers: {\n        Authorization: `JWT ${localStorage.getItem(\"JWT\")}`\n      }\n    })\n    .then(response =>{\n      const array = response?.data;\n      \n      for (const i in array){\n        const userId = array[i].id;\n        const userNames = array[i].name;\n        self.userInfo.push({name: userNames, id: userId});\n      }\n    })\n    .catch(function (error){\n      console.log(error);\n    })\n    },\n    finishedItem: function(item) {\n      this.taskData = item;\n      this.dialogFinish = true;\n    },\n    closeFinish: function() {\n      this.dialogFinish = false;\n    },\n    finishItemConfirm: function() {\n\n      const finish = \"完了\";\n      const selectName = this.taskData.user_name;\n      const selected = this.userInfo.find(({name})=>{\n            return name === selectName;\n          });\n      const id = this.taskData.task_id;\n      axios({\n        method: \"put\",\n        url: `${MyApi.apis().taskUpdate + id}/`,\n        headers: {\n          Authorization: `JWT ${localStorage.getItem(\"JWT\")}`\n        },\n        data: {\n          task_name: this.taskData.task_name,\n          user_name: selected.id,\n          status: finish,\n          priority: this.taskData.priority,\n          start_date: this.taskData.start_date,\n          end_date: this.taskData.end_date,\n        }\n      })\n      .then(response =>{\n        console.log(response);\n      })\n      .catch(function (error){\n        console.log(error);\n      })\n      this.dialogFinish = false;\n      this.getTasks();\n    }\n  },\n\n  created: function() {\n    this.getUserList();\n  },\n  beforeMount: function() {\n    this.getTasks();\n  },\n  beforeCreate: function() {\n    this.tokenCheck();\n  },\n};\n</script>\n<style scoped>\n#task {\n  width: 100%;\n  height: 100%;\n}\nh1 {\n  height: 50px;\n}\n#btnColor {\n  border-color: #0474bd;\n  background-color: #049cfc;\n  color: white;\n}\n</style>"]}]}